# v0.2.1 - Code Organization

## Overview
This specification outlines the process of removing organization/multi-tenant code and establishing a clean single-tenant foundation.

## Goals
- âœ… Remove all organization and multi-tenant code
- âœ… Establish clean codebase structure
- âœ… Prepare for Clerk authentication integration
- âœ… Set up foundation for sync service

## Implementation

### 1. Code Cleanup

#### 1.1 Remove Organization Components âœ…
1. Delete organization-specific components:
   - âœ… `features/auth/organization-provider.tsx`
   - âœ… `features/create-organization/index.tsx`
   - âœ… `routes/_authenticated/create-organization/route.lazy.tsx`
   - âœ… `routes/_authenticated/create-organization/index.lazy.tsx`

2. Clean up organization-related routes:
   - âœ… Remove organization routes from `routeTree.gen.ts`
   - âœ… Update route types and interfaces
   - âœ… Remove organization-related route declarations

3. Remove organization API endpoints:
   - âœ… Clean up organization endpoints in `lib/api.ts`
   - âœ… Remove organization-related API types and interfaces
   - âœ… Update API client initialization

#### 1.2 Clean up Layout Components âœ…
1. Update team switcher:
   - âœ… Remove `components/layout/team-switcher.tsx`
   - âœ… Update sidebar to remove team switching functionality
   - âœ… Clean up team-related types in `components/layout/types.ts`

2. Update navigation:
   - âœ… Remove organization-specific navigation items
   - âœ… Update route guards and navigation hooks
   - âœ… Clean up navigation types and interfaces

### 2. Authentication Setup âœ…

#### 2.1 Configure Clerk Routes âœ…
1. âœ… Set up auth route structure
2. âœ… Create auth pages
3. âœ… Configure environment

#### 2.2 Update Clerk Integration âœ…
1. âœ… Update Clerk provider setup
2. âœ… Clean up organization-specific Clerk hooks

#### 2.3 Protected Routes âœ…
1. âœ… Create auth middleware
2. âœ… Apply to routes

### 3. Application Structure Cleanup âœ…

#### 3.1 Clean Up Store Layer âœ…
1. âœ… Review and update stores
2. âœ… Update context providers

#### 3.2 Update Utility Functions âœ…
1. âœ… Clean up utility functions
2. âœ… Update hooks

### 4. Sync Service Preparation âœ…

#### 4.1 Clean up Data Layer âœ…
1. âœ… Update data models:
   - âœ… Remove organization fields from schemas
   - âœ… Update database types for single-tenant mode
   - âœ… Prepare models for sync service

2. âœ… Prepare for webhook integration:
   - âœ… Set up webhook handler structure
   - âœ… Implement webhook event logging
   - ðŸ”œ Future: Implement sync service
   - ðŸ”œ Future: Update API endpoints for sync flow

### 5. Route Migration âœ…

#### 5.1 TanStack Router Setup âœ…
1. âœ… Install dependencies
2. âœ… Configure Vite plugin
3. âœ… Set up router instance

#### 5.2 Route Migration âœ…
1. âœ… Update main application setup
2. âœ… Migrate existing routes

## Current Status
- âœ… Organization code removal complete
- âœ… Authentication setup complete
- âœ… Route migration complete
- âœ… Sync service foundation ready:
  - âœ… Webhook worker receiving and logging events
  - ðŸ”œ Future: Implement sync service logic
  - ðŸ”œ Future: Connect webhook events to sync service

## Success Criteria
- âœ… All organization components successfully removed
- âœ… No tenant-related types remain in the codebase
- âœ… Clean, simplified codebase structure
- âœ… Ready for Clerk authentication integration
- âœ… Foundation prepared for sync service implementation
- âœ… Successfully migrated to TanStack Router
- âœ… Clerk auth flow properly integrated

## Dependencies
- None (first step in v0.2)

## Related Stories
- STORY-3.1: Code Cleanup âœ…
- STORY-3.2: User Authentication âœ…
- STORY-3.3: Authentication Flow âœ…
- STORY-3.4: Sync Service ðŸ”œ 